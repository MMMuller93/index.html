<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Form ID — simple replace & print</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;margin:24px;max-width:980px}
  h1{font-size:22px;margin:0 0 12px}
  label{font-weight:600;margin-top:14px;display:block}
  input{width:100%;padding:10px 12px;font-size:16px;border-radius:8px;border:1px solid #ccc}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .btns{margin-top:18px;display:flex;gap:10px;flex-wrap:wrap}
  button{background:#0b5fff;color:#fff;border:0;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer}
  button.secondary{background:#eee;color:#222}
  small{color:#666}
</style>
</head>
<body>
  <h1>Form ID → simple replace & print</h1>
  <p>
    Enter a fund name and EIN, click <b>Generate & Print</b>. Exact replacements of
    <code>Defense VII, a Series of E1 VC, LLC</code> and <code>394238343</code> are performed.
  </p>

  <div class="row">
    <div>
      <label for="fund">Fund name</label>
      <input id="fund" placeholder="e.g. Defense VIII, a Series of E1 VC, LLC" />
    </div>
    <div>
      <label for="ein">EIN / Tax ID</label>
      <input id="ein" placeholder="e.g. 111111111" inputmode="numeric" />
    </div>
  </div>

  <div class="btns">
    <button id="go">Generate & Print</button>
    <button class="secondary" id="preview">Preview</button>
  </div>

  <!-- Embed your full template -->
  <script id="tpl" type="application/x-template">
  <!-- BEGIN RAW TEMPLATE -->
  <!-- contents of ford_id_template.html -->
  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <!-- full markup from ford_id_template.html goes here, exactly -->
  <!-- END RAW TEMPLATE -->
  </script>

<script>
(function(){
  const OLD_FUND = "Defense VII, a Series of E1 VC, LLC";
  const OLD_EIN  = "394238343";
  const $ = s => document.querySelector(s);
  const tpl = $("#tpl").textContent;

  function replaceAll(h, from, to){
    const esc = from.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
    return h.replace(new RegExp(esc, "g"), to);
  }

  function buildOutHTML(fund, ein){
    let out = tpl;
    if (fund) out = replaceAll(out, OLD_FUND, fund.trim());
    if (ein)  out = replaceAll(out, OLD_EIN,  ein.trim());
    const printPatch = `<style>@media print{html,body{margin:0 !important} @page{size:Letter;margin:0}}</style>`;
    out = out.replace(/<\/head>/i, m => printPatch + m);
    return out;
  }

  function openWrite(html, doPrint){
    const w = window.open("", "_blank");
    w.document.open("text/html");
    w.document.write(html);
    w.document.close();
    if (doPrint) w.addEventListener("load", () => setTimeout(() => w.print(), 300));
  }

  $("#go").addEventListener("click", ()=>{
    const html = buildOutHTML($("#fund").value, $("#ein").value);
    openWrite(html, true);
  });

  $("#preview").addEventListener("click", ()=>{
    const html = buildOutHTML($("#fund").value, $("#ein").value);
    openWrite(html, false);
  });
})();
</script>
</body>
</html>
